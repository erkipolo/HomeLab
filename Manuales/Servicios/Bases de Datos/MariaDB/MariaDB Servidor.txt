# Instalar MariaDB
apt -yq install mariadb-server

# Asegurar la instalaci√≥n del servidor de MariaDB
mysql_secure_installation
  Enter current password for root (enter for none):
  Switch to unix_socket authentication [Y/n] Y
  Change the root password? [Y/n] Y
    New password: 
    Re-enter new password:
  Remove anonymous users? [Y/n] Y
  Disallow root login remotely? [Y/n] Y
  Remove test database and access to it? [Y/n] Y
  Reload privilege tables now? [Y/n] Y

# Crear un usuario local
mysql -e "CREATE USER 'username'@'localhost' IDENTIFIED BY 'userpass';"

# Crear un usuario externo
mysql -e "CREATE USER 'username'@'%' IDENTIFIED BY 'userpass';"

# Crear una base de datos
mysql -e "CREATE DATABASE userdata /*\!40100 DEFAULT CHARACTER SET utf8 */;"

# Otorgarle todos los privilegios al usuario de una base de datos
mysql -e "GRANT ALL PRIVILEGES ON userdata.* TO 'username'@'localhost';"

# actualizar los privilegios
mysql -e "FLUSH PRIVILEGES;"

# Permitir el acceso desde el exterior al servidor
sed -i 's/bind-address            \=\ 127\.0\.0\.1/bind-address            \=\ \*/g' /etc/mysql/mariadb.conf.d/50-server.cnf

# Reiniciar el servicio
systemctl restart mysql
